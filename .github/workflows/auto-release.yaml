# ---
# name: Auto Release

# # yamllint disable-line rule:truthy
# on:
#   push:
#     branches:
#       - main
#     paths-ignore:
#       - '**.md'
#       - '.github/**'
#       - 'LICENSE*'

# jobs:
#   release:
#     name: Create Release
#     runs-on: ubuntu-latest
#     if: |
#       !contains(github.event.head_commit.message, '[skip ci]') &&
#       !contains(github.event.head_commit.message, '[skip release]')
#     steps:
#       - name: â¤µï¸ Check out code from GitHub
#         uses: actions/checkout@v6
#         with:
#           fetch-depth: 0
#       - name: ðŸš€ Run add-on information action
#         id: information
#         uses: frenck/action-addon-information@v1.4.2
#       - name: ðŸ“ Generate version
#         id: version
#         run: |
#           # Get the latest tag
#           latest_tag=$(git describe --tags --abbrev=0 2>/dev/null || echo "")

#           if [[ -z "$latest_tag" ]]; then
#             # First release - use date-based version
#             version="$(date +'%Y.%m.%d')"
#           else
#             # Extract version number from tag (remove 'v' prefix)
#             version="${latest_tag#v}"

#             # Check if this is a Renovate commit (dependency update)
#             if echo "${{ github.event.head_commit.message }}" | grep -qi "renovate\|dependenc"; then
#               # For dependency updates, increment patch version
#               IFS='.' read -ra ADDR <<< "$version"
#               major=${ADDR[0]:-0}
#               minor=${ADDR[1]:-0}
#               patch=${ADDR[2]:-0}
#               patch=$((patch + 1))
#               version="${major}.${minor}.${patch}"
#             else
#               # For other changes, use date-based version
#               version="$(date +'%Y.%m.%d')"
#             fi
#           fi

#           echo "version=${version}" >> "$GITHUB_OUTPUT"
#           echo "tag=v${version}" >> "$GITHUB_OUTPUT"
#       - name: ðŸ·ï¸ Check if tag exists
#         id: check
#         run: |
#           if git rev-parse "${{ steps.version.outputs.tag }}" >/dev/null 2>&1; then
#             echo "exists=true" >> "$GITHUB_OUTPUT"
#             echo "Tag ${{ steps.version.outputs.tag }} already exists, skipping release"
#           else
#             echo "exists=false" >> "$GITHUB_OUTPUT"
#           fi
#       - name: ðŸ“ Get commit messages since last release
#         id: changelog
#         if: steps.check.outputs.exists == 'false'
#         run: |
#           latest_tag=$(git describe --tags --abbrev=0 2>/dev/null || echo "")
#           if [[ -z "$latest_tag" ]]; then
#             commits=$(git log --pretty=format:"- %s" --no-merges)
#           else
#             commits=$(git log ${latest_tag}..HEAD --pretty=format:"- %s" --no-merges)
#           fi
#           echo "changelog<<EOF" >> "$GITHUB_OUTPUT"
#           echo "$commits" >> "$GITHUB_OUTPUT"
#           echo "EOF" >> "$GITHUB_OUTPUT"
#       - name: ðŸ“¦ Create Release
#         if: steps.check.outputs.exists == 'false'
#         uses: softprops/action-gh-release@v2
#         with:
#           tag_name: ${{ steps.version.outputs.tag }}
#           name: Release ${{ steps.version.outputs.tag }}
#           body: |
#             ## Changes in this release

#             ${{ steps.changelog.outputs.changelog }}

#             **Version:** ${{ steps.version.outputs.version }}
#             **Commit:** ${{ github.sha }}
#           draft: false
#           prerelease: false
#         env:
#           GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

